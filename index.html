<!DOCTYPE html>
<html>
<head>
  <title></title>

  
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="styles1.css">
    <!-- script src="script.js"></script> -->
  
</head>
<body>

    
  <!--   -->

    <div ng-app="myApp" class="middle">
      <div id="Todo list" class="style-1" ng-controller="TodoCtrl">
      <div id="searchBoxes">
          Search Tasks : <input type="text" ng-model="globalSearch.$">

        </div>
        <header>
            <h1>Todo List</h1>
            <input type="text" ng-model="todoText"  size="30"
             />
             <button ng-click="addTodo(todo)">Add</button>
            <!-- <input class="btn-primary" type="submit" value="add">  -->
        </header>

        <section id="main" class="scroll" style="display: block;">

            <div >
              <input id="toggle-all" type="checkbox" ng-model="markAll"
                ng-click="toggleMarkAll()"/>
                
              <label for="toggle-all">click to complete all</label>
            
            </div>
            <ul  class="unstyled">
              <li class="list-group-item" ng-repeat="todo in todos | filter:globalSearch" >
                <button type="button" ng-click="delete(todo.id)">delete</button>
                
                <label class="switch">
                  <input type="checkbox" ng-model="todo.done" />
                  <span class="slider round"></span>
                </label>
                  <span class="done-{{todo.done}}" ng-hide="todo.editing" ng-change="changeCompleted(todo)">
                  {{todo.subject}}                 
                  </span>

                  <input class="tableinputbox" type="text" ng-model="todo.subject" ng-keyup="editOnEnter(todo)"/>
                  <!-- <button type="submit" ng-hide="todo.editing" ng-click="change(todo); todo.editing =true">Edit</button>
                   <button type="submit" ng-show="todo.editing" ng-click="save($index); todo.editing === false">Save</button>
                   <button type="submit" ng-show="todo.editing" ng-click="cancel($index); todo.editing === false">Cancel</button> -->
              </li>
            </ul>
        
        </section>
        
        <footer style="display: block;">
            <div class="todo-count">completed tasks : {{todos.length - remaining()}} of {{todos.length}} </div> </br>
            <div class="todo-count">uncompleted tasks : {{remaining()}} of {{todos.length}} </div>
              
                 <!-- <button ng-click="delete(todo.id)" > Clear <span >{{(todos.length - remaining())}} {{itemText()}}</span> </button> -->
              
              <!-- <a href="" ng-click="delete()">Delete</a> -->

        </footer>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"></script>

        
              
      </div>
    </div>

    <script>
      angular.module('myApp', []);
angular.module('myApp').controller('TodoCtrl',['$scope','$http', function($scope,$http) {

  $scope.todos = [];
  $scope.markAll = false;

  $http.get('http://rest.learncode.academy/api/johnbob/r2-1')
    .success(function(todos) {
      $scope.loaded = true;
      $scope.todos = todos;
    }).error(function(err) {
      alert(err);
    });

    $scope.newField = [];

    $scope.addTodo = function(title) {
      

      $http.post('http://rest.learncode.academy/api/johnbob/r2-1', {
        subject: $scope.todoText
      }).success(function(todo) {
        
        
        $scope.todos.push({subject:$scope.todoText, done:false});
        $scope.todoText = '';
      }).error(function(err) {
        // Alert if there's an error
        return alert(err.message || "an error occurred");
      });
    }
  

  // $scope.changeDone = function(todo) {
  //   // Update the todo
  //   $http.put('http://rest.learncode.academy/api/johnbob/r2-1' + todo.id, {
  //     done: todo.done
  //   }).error(function(err) {
  //     return alert(err.message || (err.errors && err.errors.completed) || "an error occurred");
  //   });
  // };




 $scope.delete = function(text) {
     
       $http.delete('http://rest.learncode.academy/api/johnbob/r2-1/'+ text)
    .success().error(function(err) {
      alert(err);
     });
     
        var oldTodos = $scope.todos;  
        $scope.todos = [];
        angular.forEach(oldTodos, function(todo) {
           if (!todo.done) $scope.todos.push(todo);
        });
    };

  // $scope.delete = function() {
  //   $http.get('http://rest.learncode.academy/api/johnbob/r2-1/', {
  //     params: {
  //       completed: true
  //     }
  //   }).success(function(todos) {
  //     todos.forEach(function(t) { deleteTodo(todo); });
  //   });
  // };

  // function deleteTodo(t) {
  //   $http.delete('http://rest.learncode.academy/api/johnbob/r2-1/' + todo.id)
  //   .success(function() {
  //     // Find the index of an object with a matching id
  //     var index = $scope.todos.indexOf(
  //         $scope.todos.filter(function(t) {
  //           return t.id === todo.id;
  //         })[0]);

  //     if (index !== -1) {
  //       $scope.todos.splice(index, 1);
  //     }
  //   }).error(function(err) {
  //     alert(err.message || "an error occurred");
  //   });
  // }




  $scope.remove = function(){
    $scope.todos.splice(this.$index, 1)
  }


  // $scope.change = function(field){
      
  //       var todoIndex = $scope.todos.indexOf(field);
    
  //       $scope.newField[todoIndex] = angular.copy(field);
  //       $scope.todos[todoIndex].editing = true;
  //   }


  // $scope.save = function(index) {
  //     $scope.todos[index].editing = false;
  //   };

  //   $scope.cancel = function(index) {
  //       $scope.todos[index] = $scope.newField[index];      
  //   };


  

  
   

      // Find the index of an object with a matching id
  // var oldTodos = $scope.todos;
  //   $scope.todos = [];
  //   angular.forEach(oldTodos, function(todo) {
  //     if (!todo.done) $scope.todos.push(todo);
  //   });

     
   





  // $scope.addTodo = function() {

  //     if(event.keyCode == 13 && $scope.todoText){
  //         $scope.todos.push({subject:$scope.todoText, done:false});
  //         $scope.todoText = '';
  //     }
  // };
  // $scope.isTodo = function(){
  //     return $scope.todos.length > 0;  
  // };
  // $scope.toggleEditMode = function(){
  //     $(event.target).closest('li').toggleClass('editing');
  // };
  // $scope.editOnEnter = function(){
  //     if(event.keyCode == todo.subject){
  //         $scope.toggleEditMode();
  //     }
  // };
    
  $scope.remaining = function() {
    var count = 0;
    angular.forEach($scope.todos, function(todo) {
      count += todo.done ? 0 : 1;
    });
    return count;
  };

  // $scope.hasDone = function() {
  //     return ($scope.todos.length != $scope.remaining());
  // }    
    
  // $scope.itemText = function() {
  //     return ($scope.todos.length - $scope.remaining() > 1) ? "items" : "item";     
  // };
      
  $scope.toggleMarkAll = function() {
      angular.forEach($scope.todos, function(todo) {
        todo.done =$scope.markAll;
      });
    };


  }]);


  
  

  
  // $scope.title = {{todo.subject}};
  // $scope.editorEnabled = false;
  
  // $scope.enableEditor = function() {
  //   $scope.editorEnabled = true;
  //   $scope.editableTitle = $scope.title;
  // };
  
  // $scope.disableEditor = function() {
  //   $scope.editorEnabled = false;
  // };
  
  // $scope.save = function() {
  //   $scope.title = $scope.editableTitle;
  //   $scope.disableEditor();
  // };

 
    



    </script>

</body>
</html>
